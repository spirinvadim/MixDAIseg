# Mixed DAIseg

Mixed DAIseg — это Python-библиотека для анализа геномных данных, реализующая алгоритмы из [DAIseg](https://github.com/Genomics-HSE/DAIseg), [DAIseg.mex](https://github.com/Genomics-HSE/DAIseg.mex) и [DAIseg-general](https://github.com/LeoPlanche/DAIseg). Она предоставляет гибкий интерфейс для выполненияс настраиваемыми параметрами. Для работы библиотеки требуется виртуальное окружение с установленным `numpy`.

---

## Установка

1. **Создайте виртуальное окружение** (рекомендуется):
   ```bash
   python3 -m venv daiseg_env
   source daiseg_env/bin/activate  # Linux/MacOS
   # или
   daiseg_env\Scripts\activate.bat  # Windows
   ```

2. **Установите зависимости**:
   ```bash
   pip install numpy
   ```

---

## Использование

Для запуска Mixed DAIseg выполните следующую команду из рабочей директории:
```bash
python3 daiseg.py --mode <mode> [flags]
```

### Режимы и обязательные флаги

#### `--mode simple`
Соответствует реализации из [DAIseg](https://github.com/Genomics-HSE/DAIseg).  
**Обязательные флаги**:

| Флаг               | Описание                                                                | Значение              |
|--------------------|-------------------------------------------------------------------------|-----------------------|
| `--bed`            | BED-файл с регионами                                                    | Обязательно           |
| `--EM`             | Использовать алгоритм EM                                                | Обязательно           |
| `--EM_steps`       | Количество итераций EM                                                  | Нет                   |
| `--EM_samples`     | Количество образцов для алгоритма EM                                    | Нет                   |
| `--HMM_par`        | Путь к файлу параметров HMM.                                            | Обязательно           |
| `--out_prefix`     | Префикс для выходных файлов.                                            | Обязательно           |
| `--EM_est`         | Оценка всех параметров или только времени коалесценции                  | Нет                   |
| `--prepared_file`  | Путь к предобработанному файлу                                          | Обязательно           |
| `--arch_cover`     |                                                                         | Обязательно           |
| `--obs_samples`    | Файл с именами выборок                                                  | Обязательно           |
| `--decoding`       | Тип декодирования: Витерби (`viterbi`) или апостериорное (`aposteriory`)| Обязательно           |
| `--cut_off`        | Порог для декодирования                                                 | Обязательно           |

#### `--mode admixed`
Соответствует реализации из [DAIseg.mex](https://github.com/Genomics-HSE/DAIseg.mex).  
**Обязательные флаги**:

| Флаг                  | Описание                                                                | Значение              |
|-----------------------|-------------------------------------------------------------------------|-----------------------|
| `--bed`               | BED-файл с регионами                                                    | Обязательно           |
| `--EM`                | Использовать алгоритм EM                                                | Обязательно           |
| `--EM_steps`          | Количество итераций EM                                                  | Нет                   |
| `--EM_samples`        | Количество выборок для алгоритма EM                                     | Нет                   |
| `--HMM_par`           | Путь к файлу параметров HMM                                             | Обязательно           |
| `--out_prefix`        | Префикс для выходных файлов                                             | Обязательно           |
| `--prepared_file`     | Путь к предобработанному файлу                                          | Обязательно           |
| `--arch_cover`        |                                                                         | Обязательно           |
| `--obs_samples`       | Файл с именами выборок                                                  | Обязательно           |
| `--obs_type`          | Использовать условную вероятность                                       | Нет                   |
| `--transition_matrix` | Выбор типа матрицы перемещений                                          | Обязательно           |

#### `--mode general`
Соответствует реализации из [DAIseg-general](https://github.com/LeoPlanche/DAIseg).  
**Обязательные флаги**:

| Флаг            | Описание                                                                                | Значение               |
|-----------------|-----------------------------------------------------------------------------------------|------------------------|
| `--ind`         | Список ингруппы/аутгруппы (JSON-файл) или список через запятую, напр. ind1,ind2         | Обязательно            |
| `--vcfOut`      | Путь к VCF/BCF-файлу(ам) с данными аутгруппы                                            | Обязательно            |
| `--vcfIn`       | Путь к VCF/BCF-файлу(ам) с данными ингруппы                                             | Обязательно            |
| `--dem`         | Файл конфигурации демографической модели                                                | Нет                    |
| `--weights`     | Файл с показателями покрытия (по умолчанию все позиции считаются покрытыми)             | Нет                    |
| `--out_prefix`  | Префикс для выходных файлов                                                             | Нет                    |
| `--ancestral`   | FASTA-файл с информацией о предковой последовательности                                 | Нет                    |
| `--refgenome`   | FASTA-файл с референсным геномом                                                        | Нет                    |
| `--haploid`     | Использовать гаплоидные данные вместо диплоидных                                        | Нет                    |
| `--obs_type`    | Использовать условные вероятности                                                       | Нет                    |

---

Для вопросов или участия в разработке обратитесь к оригинальным репозиториям:  
- [DAIseg](https://github.com/Genomics-HSE/DAIseg)  
- [DAIseg.mex](https://github.com/Genomics-HSE/DAIseg.mex)  
- [DAIseg-general](https://github.com/LeoPlanche/DAIseg)  
```
